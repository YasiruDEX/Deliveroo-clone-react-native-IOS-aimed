"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_chunks/constants-Q2W1tUXO.cjs");exports.urlSearchParamPreviewPathname=e.b,exports.urlSearchParamPreviewSecret=e.u,exports.validatePreviewUrl=async function(r,t,i){const s=function(r){if(!r)throw new TypeError("`client` is required");if(!r.config().token)throw new TypeError("`client` must have a `token` specified");return r.withConfig({apiVersion:e.a,useCdn:!1,perspective:"published",resultSourceMap:!1,stega:!1})}(r);let n;try{n=function(r){const t=new URL(r,"http://localhost"),i=t.searchParams.get(e.u);if(!i)throw new Error("Missing secret");let s;const n=t.searchParams.get(e.b);if(n){const{pathname:e,search:r}=new URL(n,"http://localhost");s=`${e}${r}`}return{secret:i,redirectTo:s}}(t)}catch(r){return e.i&&console.error("Failed to parse preview URL",r,{previewUrl:t,client:s}),{isValid:!1}}const c=await async function(r,t,i){if("undefined"!=typeof EdgeRuntime&&await new Promise((e=>setTimeout(e,300))),!t||!t.trim())return!1;const s=await r.fetch(e.f,{secret:t},{tag:e.t,...i?void 0:{cache:"no-store"}});return!!(s?._id&&s?._updatedAt&&s?.secret)&&t===s.secret}(s,n.secret,i);return{isValid:c,redirectTo:c?n.redirectTo:void 0}};//# sourceMappingURL=index.cjs.map
