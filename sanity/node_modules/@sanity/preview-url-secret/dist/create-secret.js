import{uuid as t}from"@sanity/uuid";import{a as e,S as a,s as r,t as n,c as o,d as s}from"./_chunks/constants-BZ2GbOYw.js";async function c(c,i,p,u,l=t()){const d=c.withConfig({apiVersion:e});try{const t=new Date(Date.now()+1e3*a),e=`${r}.${l}`,s=function(){if("undefined"!=typeof crypto){const t=new Uint8Array(16);crypto.getRandomValues(t);let e="";for(let a=0;a<t.length;a++)e+=t[a].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}(),c=d.patch(e).set({secret:s,source:i,studioUrl:p,userId:u});return await d.transaction().createOrReplace({_id:e,_type:o}).patch(c).commit({tag:n}),{secret:s,expiresAt:t}}finally{await d.delete({query:s})}}export{c as createPreviewSecret};//# sourceMappingURL=create-secret.js.map
